(this["webpackJsonppet-shop-react"]=this["webpackJsonppet-shop-react"]||[]).push([[5],{1133:function(t,e){},1161:function(t,e){},1200:function(t,e){},1202:function(t,e){},1223:function(t,e){},1225:function(t,e){},1237:function(t,e){},1253:function(t,e){},1255:function(t,e){},1257:function(t,e){},1361:function(t,e){},1363:function(t,e){},1371:function(t,e){},1395:function(t,e){},1397:function(t,e){},1404:function(t,e){},1405:function(t,e){},1438:function(t,e){},1535:function(t,e){},1561:function(t,e){},1581:function(t,e){},1594:function(t,e){},1654:function(t,e){},1680:function(t,e){},1797:function(t,e){},1831:function(t,e,n){"use strict";n.r(e);var r,a=n(4),c=n.n(a),o=n(819),i=n.n(o),s=(n(870),n(342)),u=n(404),f=n(44),d=n(13),l=n(0),p=n.n(l),x=n(1896),b=n(1893),j=n(1901),h=n(1903),m=n(1904),v=n(1905),O=n(1906),g=n(1891),w=n(1895),k=n(247),y=n(839),C=n.n(y),N=n(1886),F=n(1892),T=n(1887),I=n(218);!function(t){t.dev="1337",t.production="80001"}(r||(r={}));var M=function(){var t=Object(d.a)(p.a.mark((function t(e,n){var a,c,o,i,s,u;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"===typeof window.ethereum){t.next=10;break}return a=window,c=a.ethereum,o=new I.a.providers.Web3Provider(c),t.next=5,o.getNetwork();case 5:if(i=t.sent,Number.parseInt(r.production)!==i.chainId){t.next=10;break}return s=o.getSigner(),u=new I.a.Contract(n,e.abi,s),t.abrupt("return",u);case 10:return t.abrupt("return",null);case 11:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),S=n(31),A={nfts:[],mynfts:[]},E=Object(S.d)({name:"test",initialState:A,reducers:{setNFTs:function(t,e){t.nfts=e.payload},clearNFTs:function(t){t.nfts=A.nfts},setMyNFTs:function(t,e){t.mynfts=e.payload},clearMyNFTs:function(t){t.nfts=A.mynfts}}}),P=E.actions,D=P.setNFTs,L=(P.clearNFTs,P.setMyNFTs),U=(P.clearMyNFTs,E.reducer),B=n(244),q=n.n(B),G={marketContractAddress:"0x9a697b618CE0B315Bb0D72B3Cf8604ECE0A32F65",nftContractAddress:"0x7040f31b1C027FF01F038Ee466caADc7DcB5200D"},J=function(){var t=Object(d.a)(p.a.mark((function t(e,n){var r,a,c,o,i;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M(e,G.marketContractAddress);case 2:return a=t.sent,t.next=5,M(n,G.nftContractAddress);case 5:return c=t.sent,t.next=8,null===a||void 0===a?void 0:a.fetchMarketItems();case 8:if(t.t1=r=t.sent,t.t0=null!==t.t1,!t.t0){t.next=12;break}t.t0=void 0!==r;case 12:if(!t.t0){t.next=16;break}t.t2=r,t.next=17;break;case 16:t.t2=[];case 17:return o=t.t2,t.next=20,Promise.all(o.map(function(){var t=Object(d.a)(p.a.mark((function t(e){var n,r,a,o,i;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===c||void 0===c?void 0:c.tokenURI(e.tokenId);case 2:return n=t.sent,(r=new q.a.Query("potatoNFTMarket")).equalTo("itemId",e.itemId.toNumber()),t.next=7,r.find();case 7:return a=t.sent,o=JSON.parse(a[0].get("data")),i={price:e.price.toString(),itemId:e.itemId.toNumber(),seller:e.seller,owner:e.owner,image:n,name:o.name,description:o.description},t.abrupt("return",i);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 20:return i=t.sent,console.log("loadNFTs==>".concat(i)),t.abrupt("return",i);case 23:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();function R(t,e){return W.apply(this,arguments)}function W(){return W=Object(d.a)(p.a.mark((function t(e,n){var r,a,c,o,i;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M(e,G.marketContractAddress);case 2:return a=t.sent,t.next=5,M(n,G.nftContractAddress);case 5:return c=t.sent,t.next=8,null===a||void 0===a?void 0:a.fetchMyNfts();case 8:if(t.t1=r=t.sent,t.t0=null!==t.t1,!t.t0){t.next=12;break}t.t0=void 0!==r;case 12:if(!t.t0){t.next=16;break}t.t2=r,t.next=17;break;case 16:t.t2=[];case 17:return o=t.t2,t.next=20,Promise.all(o.map(function(){var t=Object(d.a)(p.a.mark((function t(e){var n,r,a,o,i;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===c||void 0===c?void 0:c.tokenURI(e.tokenId);case 2:return n=t.sent,(r=new q.a.Query("potatoNFTMarket")).equalTo("itemId",e.itemId.toNumber()),t.next=7,r.find();case 7:return a=t.sent,o=JSON.parse(a[0].get("data")),i={price:e.price.toString(),itemId:e.itemId.toNumber(),seller:e.seller,owner:e.owner,image:n,name:o.name,description:o.description},t.abrupt("return",i);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 20:return i=t.sent,console.log("loadMyNFTs==>".concat(i)),t.abrupt("return",i);case 23:case"end":return t.stop()}}),t)}))),W.apply(this,arguments)}var _,K=n(347),H=function(){return Object(K.b)()},Q=K.c,V=n(24),Z=n(521),z=n.n(Z),X=function(){var t=Object(a.useState)(),e=Object(V.a)(t,2),n=e[0],r=e[1],c=Object(a.useState)(),o=Object(V.a)(c,2),i=o[0],s=o[1];return Object(a.useEffect)((function(){z()("definition/PotatoMarket.json").then((function(t){r(t.data),console.log({json:t.data})})),z()("definition/NFT.json").then((function(t){s(t.data)}))}),[]),{potatoMarketContract:n,NFTContract:i}},Y=n(14),$=function(t){var e=t.data,n=t.isForSale,r=void 0===n||n,a=H(),c=X(),o=c.potatoMarketContract,i=c.NFTContract,s=function(){var t=Object(d.a)(p.a.mark((function t(){var n,c,s;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!o||!i){t.next=11;break}return t.next=3,M(o,G.marketContractAddress);case 3:return n=t.sent,c=I.a.utils.formatUnits(e.price,"wei"),t.next=7,n.createMarketSale(G.nftContractAddress,e.itemId,{value:c.toString(),gasLimit:"6721975",gasPrice:"20000000000"});case 7:return s=t.sent,t.next=10,s.wait();case 10:r&&(J(o,i).then((function(t){a(D(t))})),R(o,i).then((function(t){a(L(t))})));case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(Y.jsxs)(j.a,{sx:{maxWidth:250},children:[Object(Y.jsx)(h.a,{avatar:Object(Y.jsx)(g.a,{sx:{bgcolor:k.a[500]},"aria-label":"recipe",children:"K"}),action:Object(Y.jsx)(w.a,{"aria-label":"settings",children:Object(Y.jsx)(C.a,{})}),title:e.name}),Object(Y.jsx)(m.a,{component:"img",height:"150",image:e.image}),Object(Y.jsx)(v.a,{children:r&&Object(Y.jsx)(x.a,{children:"".concat(I.a.utils.formatUnits(e.price,"ether")," PTT")})}),Object(Y.jsx)(O.a,{disableSpacing:!0,children:r&&Object(Y.jsx)(N.a,{direction:"row",spacing:2,children:Object(Y.jsx)(F.a,{variant:"contained",endIcon:Object(Y.jsx)(T.a,{}),onClick:s,children:"Buy"})})})]})},tt=n(841),et=n.n(tt);!function(t){t.Log="Log"}(_||(_={}));var nt=function(){var t=Object(d.a)(p.a.mark((function t(){var e,n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"===typeof window.ethereum){t.next=3;break}return e=window,n=e.ethereum,t.abrupt("return",new et.a(n));case 3:return t.abrupt("return",null);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),rt=function(){var t=Object(d.a)(p.a.mark((function t(){var e;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,nt();case 2:return e=t.sent,t.abrupt("return",null===e||void 0===e?void 0:e.eth.net.getId());case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),at=function(){var t=Object(d.a)(p.a.mark((function t(){var e,n,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"===typeof window.ethereum){t.next=6;break}return e=window,n=e.ethereum,t.next=4,n.request({method:"eth_requestAccounts"});case 4:return r=t.sent,t.abrupt("return",r);case 6:return t.abrupt("return",[]);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),ct=function(){var t=Object(d.a)(p.a.mark((function t(){var e;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,at();case 2:return e=t.sent,t.next=5,rt();case 5:return 1337!==t.sent&&console.log("incurrect chain"),t.abrupt("return",e);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),ot=function(t){"undefined"!==typeof window.ethereum&&window.ethereum.on("chainChanged",(function(e){t&&t(parseInt(e,16))}))},it=[{title:"Expore",path:"",element:function(){var t=Q((function(t){return t.expore})).nfts,e=H(),n=X(),r=n.potatoMarketContract,c=n.NFTContract,o=Object(a.useCallback)((function(){r&&c&&J(r,c).then((function(t){e(D(t))}))}),[r,c]);return Object(a.useEffect)((function(){ct().then((function(t){t&&t[0]&&o()}))}),[o]),ot(function(){var t=Object(d.a)(p.a.mark((function t(n){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:1337!==n?(console.log("incurrect chain"),e(D([]))):o();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),Object(Y.jsx)(x.a,{p:4,sx:{flexGrow:1},children:Object(Y.jsx)(b.a,{container:!0,spacing:1,children:t.map((function(t,e){return Object(Y.jsx)(b.a,{item:!0,lg:2,children:Object(Y.jsx)($,{data:t})},e)}))})})}},{title:"My item",path:"my-item",element:function(){var t,e=Q((function(t){return t.expore})).mynfts,n=H(),r=X(),c=r.potatoMarketContract,o=r.NFTContract,i=Object(a.useCallback)((function(){c&&o&&R(c,o).then((function(t){n(L(t))}))}),[c,o]);return Object(a.useEffect)((function(){ct().then((function(t){t&&t[0]&&i()}))}),[i]),t=function(t){i()},"undefined"!==typeof window.ethereum&&window.ethereum.on("accountsChanged",(function(e){t&&t(e)})),ot(function(){var t=Object(d.a)(p.a.mark((function t(e){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:1337!==e?(console.log("incurrect chain"),n(L([]))):i();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),Object(Y.jsx)(x.a,{p:4,sx:{flexGrow:1},children:Object(Y.jsx)(b.a,{container:!0,spacing:1,children:e.map((function(t,e){return Object(Y.jsx)(b.a,{item:!0,lg:2,children:Object(Y.jsx)($,{data:t,isForSale:!1})},e)}))})})}}],st=n(1897),ut=n(1899),ft=n(1894),dt=n(1898),lt=n(1889),pt=n(523),xt=function(){var t=Object(s.b)(),e=t.authenticate,n=t.isAuthenticated,r=(t.isAuthenticating,t.user,t.account,t.logout,H()),c=X(),o=c.NFTContract,i=c.potatoMarketContract,f={name:pt.a.company.companyName(),description:pt.a.commerce.productDescription(),price:"2"},l=Object(a.useState)(),b=Object(V.a)(l,2),j=b[0],h=b[1],m=Object(s.c)().saveFile,v=function(){var t=Object(d.a)(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:j&&m(j.name,j,{type:"base64",saveIPFS:!0,onSuccess:function(){var t=Object(d.a)(p.a.mark((function t(e){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.ipfs(),e&&O(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),onError:function(t){return console.log(t)}});case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),O=function(){var t=Object(d.a)(p.a.mark((function t(e){var n,a,c,s,u,d,l,x,b,j,m,v,O,g;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=f.name,a=f.description,!i||!o){t.next=36;break}return t.next=5,M(i,G.marketContractAddress);case 5:return c=t.sent,t.next=8,M(o,G.nftContractAddress);case 8:return s=t.sent,t.next=11,s.mintToken(e);case 11:return u=t.sent,t.next=14,u.wait();case 14:return d=t.sent,l=d.events[0],x=l.args[2],b=x.toNumber(),j=JSON.stringify({url:e,name:n,description:a}),(m=new q.a.Object("potatoNFTMarket")).set("itemId",b),m.set("data",j),t.next=24,m.save();case 24:return v=I.a.utils.parseUnits(f.price,"ether"),console.log({price:v}),t.next=28,null===c||void 0===c?void 0:c.getListingPrice();case 28:return O=t.sent,t.next=31,null===c||void 0===c?void 0:c.makeMarketItem(G.nftContractAddress,b,v.toString(),{value:O.toString()});case 31:return g=t.sent,t.next=34,g.wait();case 34:J(i,o).then((function(t){r(D(t))})),h(void 0);case 36:t.next=41;break;case 38:t.prev=38,t.t0=t.catch(0),console.log("Error: ",t.t0);case 41:case"end":return t.stop()}}),t,null,[[0,38]])})));return function(e){return t.apply(this,arguments)}}();return Object(Y.jsx)(st.a,{position:"static",children:Object(Y.jsx)(dt.a,{maxWidth:"xl",children:Object(Y.jsxs)(ut.a,{disableGutters:!0,children:[Object(Y.jsx)(ft.a,{variant:"h6",noWrap:!0,component:"div",sx:{mr:2,display:{xs:"none",md:"flex"}},children:"Potato NFT Market"}),Object(Y.jsx)(x.a,{sx:{flexGrow:1,display:{xs:"none",md:"flex"}},children:it.map((function(t){return Object(Y.jsx)(u.b,{to:"/".concat(t.path),children:Object(Y.jsx)(F.a,{sx:{my:2,color:"white",display:"block"},children:t.title})},t.title)}))}),Object(Y.jsx)("input",{type:"file",onChange:function(t){h(t.target.files[0])}}),Object(Y.jsx)(x.a,{sx:{flexGrow:1,display:{xs:"none",md:"flex"}},children:Object(Y.jsx)(F.a,{variant:"outlined",color:"secondary",sx:{my:2,color:"white",display:"block"},onClick:v,children:"listing"})}),Object(Y.jsx)(x.a,{sx:{flexGrow:0},children:Object(Y.jsx)(lt.a,{title:"Open settings",children:Object(Y.jsx)(w.a,{sx:{p:0},onClick:function(){console.log("process.env.NODE_ENV==>","production"),n||e({signingMessage:"Log in using Moralis"}).then((function(t){console.log("logged in user:",t),console.log(null===t||void 0===t?void 0:t.get("ethAddress"))})).catch((function(t){console.log(t)}))},children:Object(Y.jsx)(g.a,{alt:"Remy Sharp",src:"/static/images/avatar/2.jpg"})})})})]})})})};var bt=function(){return Object(Y.jsx)(s.a,{serverUrl:"https://jqffj1drjnzm.usemoralis.com:2053/server",appId:"iABVUKAeoEkI52Lnjt1dZrIgHuvo62ZHKk9qNDds",children:Object(Y.jsxs)(u.a,{children:[Object(Y.jsx)(xt,{}),Object(Y.jsx)(f.c,{children:it.map((function(t,e){return Object(Y.jsx)(f.a,{path:t.path,element:t.element()},e)}))})]})})},jt=Object(S.d)({name:"test",initialState:{toogle:!1},reducers:{updateToggle:function(t,e){t.toogle=e.payload}}}),ht=(jt.actions.updateToggle,jt.reducer),mt=n(1888),vt=Object(S.a)({reducer:{test:ht,expore:U}});Object(mt.a)(vt.dispatch);var Ot=vt,gt=function(t){t&&t instanceof Function&&n.e(18).then(n.bind(null,2162)).then((function(e){var n=e.getCLS,r=e.getFID,a=e.getFCP,c=e.getLCP,o=e.getTTFB;n(t),r(t),a(t),c(t),o(t)}))},wt=function(){return Object(Y.jsx)(c.a.StrictMode,{children:Object(Y.jsx)(K.a,{store:Ot,children:Object(Y.jsx)(bt,{})})})};i.a.createRoot(document.getElementById("root")).render(Object(Y.jsx)(wt,{})),gt()},699:function(t,e){function n(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=699},870:function(t,e,n){}},[[1831,6,7]]]);
//# sourceMappingURL=main.289ea65a.chunk.js.map